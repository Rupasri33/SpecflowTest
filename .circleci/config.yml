# Use the latest 2.1 version of CircleCI pipeline process engine. See: https://circleci.com/docs/2.0/configuration-reference
version: 2.1
# Use a package of configuration called an orb.
orbs:
  # Declare a dependency on the welcome-orb
  win: circleci/windows@2.4
# Orchestrate or schedule a set of jobs

jobs:
    build: 
      executor:       
        name: win/default
        size: medium      
      steps:       
        - checkout
        - run: 
            name: "Hello world"
            command: echo "hello building Automation solution"
        - run: 
           name: "print env variables"
           command: "Get-ChildItem env:"
           
        - run:
            name: "Get working directory"
            command: Get-Location
            shell: powershell
        - run:
            name: "Get local directory files"
            command: Get-ChildItem
            shell: powershell
        - run:
            name: "Restore nuget packages"
            command: nuget restore SpecflowParallelTest.sln
            shell: powershell
            
        - run: 
            name: "build VS proj"
            command: msbuild SpecflowParallelTest.sln /t:Build /p:RunOctoPack=true /fl /flp:errorsonly;
  
    deploy-to-nexus:
      executor:       
        name: win/default
        size: medium
      steps:
      - run:
          name: Writing an Example File
          command: echo "some file content" > package-$CIRCLE_SHA1.txt
       
       
workflows:
  version: 2
  cloud-automation-build: 
    jobs:
      - build
      - deploy-to-nexus:
          context: teleadmin
